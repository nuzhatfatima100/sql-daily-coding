Assume you're given a table containing data on Amazon customers and their spending on products in different category, 
write a query to identify the top two highest-grossing products within each category in the year 2022. 
The output should include the category, product, and total spend.

with cte as(SELECT category,product,sum(spend) as expense FROM product_spend
where extract(year from transaction_date) ='2022'
group by category,product),
cte2 as (

select category,product,expense, 
dense_rank() over( partition by category order by expense DESC) as rnk
from cte)
select category,product,expense from cte2 
where rnk in (1,2);
